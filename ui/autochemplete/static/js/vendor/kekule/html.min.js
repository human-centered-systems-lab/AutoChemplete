!function(e,t){"use strict";var n,r,i;e.Kekule||(Kekule={}),Kekule.Browser={IE:!(!e.attachEvent||e.opera),Opera:!!e.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("like Gecko")<0&&-1==navigator.userAgent.indexOf("KHTML"),MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),language:navigator.language||navigator.browserLanguage},Kekule.Browser.IEVersion=Kekule.Browser.IE&&(-1!==(n=navigator.userAgent.toLowerCase()).indexOf("msie")&&parseInt(n.split("msie")[1])),Kekule.BrowserFeature={typedArray:"undefined"!=typeof ArrayBuffer,svg:!!e.SVGSVGElement,canvas:!!e.CanvasRenderingContext2D,webgl:!!function(){try{var n=t.createElement("canvas");return!!e.WebGLRenderingContext&&(n.getContext("webgl")||n.getContext("experimental-webgl"))}catch(e){return!1}}(),downloadHref:"download"in t.createElement("a"),blob:!!e.Blob,workers:!!e.Worker,fileapi:!!(e.File&&e.FileReader&&e.FileList&&e.Blob),sessionStorage:function(){try{return!!e.sessionStorage}catch(e){return!1}}(),localStorage:function(){try{return!!e.localStorage}catch(e){return!1}}(),cssTransition:(i=t.createElement("div").style,"transition"in i||"WebkitTransition"in i||"MozTransition"in i||"msTransition"in i||"OTransition"in i),cssTranform:function(e){return"transform"in e||"WebkitTransform"in e||"MozTransform"in e||"msTransform"in e||"OTransform"in e}(t.createElement("div").style),cssFlex:function(e){return"flex"in e||"WebkitFlex"in e||"MozFlex"in e||"msFlex"in e||"OFlex"in e}(t.createElement("div").style),html5Form:{placeholder:"placeholder"in t.createElement("input"),supportType:function(e){var n=t.createElement("input");n.setAttribute("type",e);var r=n.type===e;if(r&&["text","url","search"].indexOf(e.toLowerCase())<0){n.value=":)",r=":)"!==n.value}return r}},mutationObserver:e.MutationObserver||e.MozMutationObserver||e.WebkitMutationObserver,touchEvent:!!e.touchEvent,pointerEvent:!!e.PointerEvent,draggable:(r=t.createElement("div"),"draggable"in r||"ondragstart"in r&&"ondrop"in r)},function(){for(var t=0,n=["ms","moz","webkit","o"],r=0;r<n.length&&!e.requestAnimationFrame;++r)e.requestAnimationFrame=e[n[r]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[n[r]+"CancelAnimationFrame"]||e[n[r]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(n,r){var i=(new Date).getTime(),a=Math.max(0,16-(i-t)),o=e.setTimeout(function(){n(i+a)},a);return t=i+a,o}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){clearTimeout(e)})}(),Kekule.X={};var a,o=Kekule.X,l=function(e){return!function(e){return null==e}(e)},u=function(t){var n=e.getComputedStyle?e.getComputedStyle(t,null).position:t.currentStyle?t.currentStyle.position:null;return!!n&&(!!n&&("relative"===(n=n.toString().toLowerCase())||"absolute"===n))};if(o.MutationObserver=e.MutationObserver||e.MozMutationObserver||e.WebkitMutationObserver,o.Event={MOUSE_BTN_LEFT:0,MOUSE_BTN_RIGHT:2,MOUSE_BTN_MID:1,MOUSE_BTN_LR:3},o.Event.PointerType={MOUSE:"mouse",TOUCH:"touch",PEN:"pen"},o.Event.MouseButton={LEFT:0,RIGHT:2,MID:1,LR:3},o.Event.KeyCode={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRTSC:44,INS:45,DEL:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},o.Event.isSupported=(a={},function(n){if(0===n.indexOf("touch"))return Kekule.BrowserFeature.touchEvent;if(0===n.indexOf("pointer"))return Kekule.BrowserFeature.pointerEvent;var r={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img",unload:"win",resize:"win"},i=n.replace(/^on/,"");if(a[i])return a[i];var o="win"==r[i]?e:t.createElement(r[i]||"div"),l=(n="on"+i)in o;return l||(o.setAttribute(n,"return;"),l="function"==typeof o[n]),o=null,a[i]=l,l}),o.Event.Methods={getType:function(e){return e.__$type__||e.type},setType:function(e,t){e.__$type__=t;try{e.type=t}catch(e){}},getPointerType:function(e){return e.pointerType},getTarget:function(e){var t=e.__$target__||e.target||e.srcElement;return 3==t.nodeType&&(t=t.parentNode),t},setTarget:function(e,t){e.__$target__=t;try{e.target=t}catch(e){}},getCurrentTarget:function(e){return e.currentTarget},getEventPhase:function(e){return e.eventPhase},getAltKey:function(e){return e.altKey},getCtrlKey:function(e){return e.ctrlKey},getShiftKey:function(e){return e.shiftKey},getCharCode:function(e){return l(e.charCode)?e.charCode:e.keyCode},getKeyCode:function(e){return e.keyCode},getClientX:function(e){var t;if(e.touches){var n=e.touches[0];t=n&&n.clientX}return void 0===t&&(t=e.clientX),t},getClientY:function(e){var t;if(e.touches){var n=e.touches[0];t=n&&n.clientY}return void 0===t&&(t=e.clientY),t},getScreenX:function(e){var t;if(e.touches){var n=e.touches[0];t=n&&n.screenX}return void 0===t&&(t=e.screenX),t},getScreenY:function(e){var t;if(e.touches){var n=e.touches[0];t=n&&n.screenY}return void 0===t&&(t=e.screenY),t},getPageX:function(e){var t;if(e.touches){var n=e.touches[0];n&&l(n.pageX)&&(t=n.pageX)}if(void 0===t&&l(e.pageX)&&(t=e.pageX),void 0===t){var r=o.Event.getTarget(e).ownerDocument||o.Event.getTarget(e),i=r?r.body:null;t=o.Event.getClientX(e)+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0)}return t},getPageY:function(e){var t;if(e.touches){var n=e.touches[0];if(n&&l(n.pageY))return n.pageY}else if(void 0===t&&l(e.pageY))return e.pageY;if(void 0===t){var r=o.Event.getTarget(e).ownerDocument||o.Event.getTarget(e),i=r?r.body:null;t=o.Event.getClientY(e)+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)}return t},getOffsetX:function(e){if(l(e.offsetX))return e.offsetX;var t=o.Event.getTarget(e);if((t.defaultView||t.parentWindow)&&t.body&&(t=t.body),l(e.layerX)&&u(t)&&!e.touches)return e.layerX;var n=o.Event.getClientX(e);return Math.round(n-Kekule.HtmlElementUtils.getElemPagePos(t,!0).x)},getOffsetY:function(e){if(l(e.offsetY))return e.offsetY;var t=o.Event.getTarget(e);if((t.defaultView||t.parentWindow)&&t.body&&(t=t.body),l(e.layerY)&&u(t)&&!e.touches)return e.layerY;var n=o.Event.getClientY(e);return Math.round(n-Kekule.HtmlElementUtils.getElemPagePos(t,!0).y)},getOffsetCoord:function(e,t){var n,r=o.Event.getTarget(e);if(t&&Kekule.ObjUtils.isUnset(e.offsetX)&&(n=Kekule.StyleUtils.getTotalTransformMatrix(r)),n){var i=o.Event.getClientX(e),a=o.Event.getClientY(e),l={x:i-Kekule.HtmlElementUtils.getElemBoundingClientRect(r).x,y:a-Kekule.HtmlElementUtils.getElemBoundingClientRect(r).y},u=Kekule.StyleUtils.calcInvertTransformMatrix(n);if(u){var s=Kekule.MatrixUtils.create(3,1);s[0][0]=l.x,s[1][0]=l.y,s[2][0]=1;var c=Kekule.MatrixUtils.multiply(u,s);return l.x=c[0][0],l.y=c[1][0],l}}return{x:o.Event.getOffsetX(e),y:o.Event.getOffsetY(e)}},getWindowX:function(e){var t=o.Event.getPageX(e),n=e.target.ownerDocument||e.target,r=n&&(n.defaultView||n.parentWindow);return t-(r&&r.scrollX||0)},getWindowY:function(e){var t=o.Event.getPageY(e),n=e.target.ownerDocument||e.target,r=n&&(n.defaultView||n.parentWindow);return t-(r&&r.scrollY||0)},getRelXToCurrTarget:function(e){var t=o.Event.getCurrentTarget(e);(t.defaultView||t.parentWindow)&&t.body&&(t=t.body);var n=o.Event.getClientX(e);return Math.round(n-Kekule.HtmlElementUtils.getElemPagePos(t,!0).left)},getRelYToCurrTarget:function(e){var t=o.Event.getCurrentTarget(e);(t.defaultView||t.parentWindow)&&t.body&&(t=t.body);var n=o.Event.getClientY(e);return Math.round(n-Kekule.HtmlElementUtils.getElemPagePos(t,!0).top)},getTouches:function(e){return e.touches}},o.Event._MouseEventEx={isMouseEnterLeaveEvent:function(e){return"mouseenter"===e||"mouseleave"===e},addMouseEnterLeaveListener:function(t,n,r,i){if("mouseenter"===n&&o.Event.isSupported("mouseenter")||"mouseleave"===n&&o.Event.isSupported("mouseleave"))return t.addEventListener(n,r,i);var a=function(t){var i=t.getTarget?t.getTarget():t.target,a=t.getCurrentTarget?t.getCurrentTarget():t.currentTarget;if(i===a||Kekule.DomUtils.isDescendantOf(i,a)){var o=t.getRelatedTarget?t.getRelatedTarget():t.relatedTarget;if(!o||!Kekule.DomUtils.isDescendantOf(o,a)){var l=new MouseEvent(n,{view:e,bubbles:!1,cancelable:!0,target:a,currentTarget:a,relatedTarget:o});r.call(a,l)}}};r.__$mouseExListenerWrapper__=a;var l="mouseenter"===n?"mouseover":"mouseout";return t.addEventListener(l,a,i)},removeMouseEnterLeaveListener:function(e,t,n){if("mouseenter"===t&&o.Event.isSupported("mouseenter")||"mouseleave"===t&&o.Event.isSupported("mouseleave"))return e.removeEventListener(t,n);var r="mouseenter"===t?"mouseover":"mouseout";return e.removeEventListener(r,n.__$mouseExListenerWrapper__||n)}},o.Event._W3C={addListener:function(e,t,n,r){return o.Event._MouseEventEx.isMouseEnterLeaveEvent(t)?o.Event._MouseEventEx.addMouseEnterLeaveListener(e,t,n,r):e.addEventListener(t,n,r)},removeListener:function(e,t,n,r){return o.Event._MouseEventEx.isMouseEnterLeaveEvent(t)&&n.__$listenerWrapper__?o.Event._MouseEventEx.removeMouseEnterLeaveListener(e,t,n.__$listenerWrapper__):e.removeEventListener(t,n,r)},stopPropagation:function(e){e.stopPropagation()},preventDefault:function(e){e.preventDefault()}},o.Event._W3CMethods={getRelatedTarget:function(e){return e.relatedTarget},getButton:function(e){return e.button}},o.Event._Gecko={addListener:function(e,t,n,r){if(o.Event._MouseEventEx.isMouseEnterLeaveEvent(t))return o.Event._MouseEventEx.addMouseEnterLeaveListener(e,t,n,r);if("mousewheel"===t){var i=function(t){t.wheelDeltaY=t.wheelDelta=40*-t.detail,t.__$type__="mousewheel",n.call(e,t)};n.__$mousewheelListenerWrapper__=i,e.addEventListener("DOMMouseScroll",i,r)}else e.addEventListener(t,n,r)},removeListener:function(e,t,n,r){"mousewheel"===t&&n.__$mousewheelListenerWrapper__?e.removeEventListener("DOMMouseScroll",n.__$mousewheelListenerWrapper__,r):e.removeEventListener(t,n,r)}},o.Event._IE={_handlers:{},WIN_UNLOAD_FLAG_FIELD:"__$win_unload_linked__",addListener:function(t,n,r,i){if(!(o.Event.findHandlerIndex(t,n,r)>=0)){var a=function(n){n||(n=e.event),n.currentTarget=t,n.eventPhase=n.srcElement===t?2:3,d||Object.extend(n,f),r.call(t,n)};t.attachEvent(o.Event.getEventName(n),a),o.Event.registerHandler(t,n,r,a);var l=t.ownerDocument||t,u=l.parentWindow||l;o.Event._linkUnloadEvent(u)}},removeListener:function(e,t,n,r){var i=o.Event.findHandlerIndex(e,t,n);if(i>=0){var a=o.Event._handlers[t][i].wrapper;e.detachEvent(o.Event.getEventName(t),a),o.Event._handlers[t].splice(i,1)}},stopPropagation:function(e){e.cancelBubble=!0},preventDefault:function(e){e.returnValue=!1},removeAllListeners:function(e){var t=o.Event._handlers;if(t)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(r&&r.length)for(var i=o.Event.getEventName(n),a=r.length-1;a>=0;--a){var l=r[a];e&&l.element.ownerDocument!==e||(l.element.detachEvent(i,l.wrapper),r.splice(a,1))}}},getEventName:function(e){return"on"+e},registerHandler:function(e,t,n,r){var i=o.Event._handlers;i[t]||(i[t]=[]),i[t].push({element:e,handler:n,wrapper:r})},unregisterHandler:function(e,t,n){if(n[t]){var r=n[t],i=o.Event.findHandlerIndex(e,t,n);i>=0&&r.splice(i,1)}},findHandlerIndex:function(e,t,n){var r=o.Event._handlers[t];if(!r)return-1;for(var i=0,a=r.length;i<a;++i){var l=r[i];if(l.element===e&&l.handler===n)return i}return-1},_linkUnloadEvent:function(e){var t=o.Event.WIN_UNLOAD_FLAG_FIELD;e[t]||(e.attachEvent("onunload",o.Event.reactWinUnload),e[t]=!0)},reactWinUnload:function(){var e=this.ownerDocument;o.Event.removeAllListeners(e)}},o.Event._IEMethods={getRelatedTarget:function(e){var t=e.type;return["focusin","mouseenter","mouseover","pointerenter","pointerover","dragenter"].indexOf(t)>=0?e.fromElement||e.toElement:e.toElement||e.fromElement},getButton:function(e){switch(e.button){case 1:return 0;case 2:return 2;case 4:return 1;case 3:return 3;default:return e.button}},stopPropagation:function(e){e.cancelBubble=!0},preventDefault:function(e){e.returnValue=!1}},t.addEventListener)o.Event=Object.extend(o.Event,o.Event._W3C),o.Event.Methods=Object.extend(o.Event.Methods,o.Event._W3CMethods),Kekule.Browser.Gecko&&(o.Event=Object.extend(o.Event,o.Event._Gecko));else if(t.attachEvent&&(o.Event=Object.extend(o.Event,o.Event._IE),o.Event.Methods=Object.extend(o.Event.Methods,o.Event._IEMethods),e.Element)){var s=e.Element.prototype;s.addEventListener=o.Event.addListener.methodize(),s.removeEventListener=o.Event.removeListener.methodize()}Object.extend(o.Event,o.Event.Methods);var c=null;e.Event&&(c=e.Event.prototype),c||t.createEvent&&(c=t.createEvent("HTMLEvents").__proto__);var d=!!c,f={},m=o.Event.Methods;for(var v in m)m.hasOwnProperty(v)&&"function"==typeof m[v]&&(f[v]=m[v].methodize());c&&Object.extend(c,f),function(){if(void 0!==t){var e=t.createElement("div");!("draggable"in e)&&"ondragstart"in e&&"ondrop"in e&&Kekule.X.Event.addListener(t,"selectstart",function(e){for(var t=e.target;t;t=t.parentNode)if(t.attributes&&t.attributes.draggable)return e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation(),t.dragDrop(),!1})}}(),o.Ajax={XMLHttpFactories:[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],_availableFactoryIndex:-1,createXMLHTTPObject:function(){var e=!1,t=o.Ajax.XMLHttpFactories,n=o.Ajax._availableFactoryIndex;if(n>=0)e=t[n]();else for(var r=0;r<t.length;r++){try{e=t[r](),o.Ajax._availableFactoryIndex=r}catch(e){continue}break}return e},preparePostData:function(e){var t=e;return"object"==typeof e&&(t=Kekule.UrlUtils.generateSearchString(e)),t},sendRequest:function(e,t,n,r,i){var a=!1,l=!0,u=o.Ajax.createXMLHTTPObject();if(u){var s=n?"POST":"GET";if(u.open(s,e,!0),u.setRequestHeader("User-Agent","XMLHTTP/1.0"),n&&u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r){try{u.responseType=r}catch(e){}"arraybuffer"!==r&&"blob"!==r||(a=!0),u.responseType!==r&&(l=!1)}if(a&&!l&u.overwriteMimeType&&u.overrideMimeType("text/plain; charset=x-user-defined"),i&&u.overwriteMimeType&&u.overwriteMimeType(i),u.onreadystatechange=function(){if(4==u.readyState){if(200!=u.status&&304!=u.status)throw t(null,u,!1),"HTTP error "+u.status;t(u.response||u.responseText,u,!0)}},4!=u.readyState)return u.send(o.Ajax.preparePostData(n)),u}},getResponseMimeType:function(e){return e.getResponseHeader("content-type")||""}},Kekule.Ajax=Kekule.X.Ajax,Kekule.X.DomReady={isReady:!1,suspendFlag:0,funcs:[],domReady:function(e){if(g.initReady(),!g.isReady){var n=t&&t.readyState;("complete"===n||"loaded"===n||"interactive"===n&&!Kekule.Browser.IE)&&(g.isReady=!0)}g.isReady?e():g.funcs.push(e)},fireReady:function(){g.isReady||(g.isReady=!0,g._execFuncs())},_execFuncs:function(){var e=g.funcs;if(e&&e.length)for(;e.length&&!g.isSuspending();){var t=e.shift();t&&t()}},suspend:function(){++g.suspendFlag},resume:function(){g.suspendFlag>0&&--g.suspendFlag,g.isSuspending()||g._execFuncs()},isSuspending:function(){return g.suspendFlag>0},initReady:function e(){t.addEventListener?t.addEventListener("DOMContentLoaded",function(){t.removeEventListener("DOMContentLoaded",e,!1),g.fireReady()},!1):t.getElementById&&(t.write('<script id="ie-domReady" defer="defer" src="//:"><\/script>'),t.getElementById("ie-domReady").onreadystatechange=function(){"complete"===this.readyState&&(g.fireReady(),this.onreadystatechange=null,this.parentNode.removeChild(this))})}};var g=Kekule.X.DomReady;Kekule.X.domReady=g.domReady}(window,document),function(){"use strict";Kekule.NativeServices={MODE_OPEN:"open",MODE_SAVE:"save",FILTER_ALL_SUPPORT:"all",FILTER_ANY:"any",showFilePickerDialog:function(e,t,n){if(Kekule.NativeServices.doShowFilePickerDialog)return Kekule.NativeServices.doShowFilePickerDialog(e,t,n)},canLoadFileData:function(t){return!!e.doLoadFileData||!!e.doShowFilePickerDialog},loadFileData:function(t,n,r){if(Kekule.NativeServices.doLoadFileData)return Kekule.NativeServices.doLoadFileData(t,n,r);var i=Object.create(r||{});i.multiple=!1,i.mode=e.MODE_OPEN;e.showFilePickerDialog(t,function(e,t,r){if(e&&t)if(Kekule.BrowserFeature.fileapi){var a=t.name,o=i.binaryDetector&&i.binaryDetector(a,t),l=new FileReader;l.onload=function(e){var t=l.result;n&&n(!0,t,a)},l.onerror=function(){n&&n(!1),Kekule.error(Kekule.$L("ErrorMsg.ERROR_LOADING_FILE"+a))},o?l.readAsArrayBuffer(t):l.readAsText(t)}else Kekule.error(Kekule.$L("ErrorMsg.FILE_API_NOT_SUPPORTED"));else n(e,null,null)},i)},canSaveFileData:function(t){return!!e.doSaveFileData},saveFileData:function(e,t,n,r){if(Kekule.NativeServices.doSaveFileData)return Kekule.NativeServices.doSaveFileData(e,t,n,r)}};var e=Kekule.NativeServices;Kekule.HtmlNativeServiceImpl={doShowFilePickerDialog:function(e,t,n){Kekule.HtmlNativeServiceImpl._createFileInputElem(e,t,n||{}).click()},_createFileInputElem:function(e,t,n){var r=e.createElement("input");r.setAttribute("type","file");var i=n||{};if(i.multiple&&r.setAttribute("multiple","multiple"),i.filters){for(var a=[],o=0,l=i.filters.length;o<l;++o){var u=i.filters[o];if(u!==Kekule.NativeServices.FILTER_ALL_SUPPORT&&u!==Kekule.NativeServices.FILTER_ANY){var s=u.filter;s&&a.push(s)}}var c=a.join(",");r.setAttribute("accept",c)}var d=r.style;d.position="absolute",d.left="-100000px",d.opacity=0,e.body.appendChild(r);var f=function(e){var n=e.getTarget(),r=n.files,i=r&&r[0];t&&t(!0,i,r),Kekule.X.Event.removeListener(n,"change",f),n.ownerDocument.body.focus(),n.parentNode};return Kekule.X.Event.addListener(r,"change",f),r},doSaveFileData:function(e,t,n,r){var i=r.initialFileName||null,a=Kekule.HtmlNativeServiceImpl._createDataElem(e,t,i);a.click(),a.parentNode.removeChild(a),n&&n(null,null)},_createDataElem:function(e,t,n){var r=e.createElement("a"),i="data:application/octet-stream,"+encodeURIComponent(t);r.setAttribute("href",i),r.setAttribute("download",n||"");r.style;return r.position="absolute",r.left="-100000px",r.opacity=0,e.body.appendChild(r),r},doSaveFileDataIe:function(e,t,n,r){var i=r.initialFileName||null;if(Kekule.BrowserFeature.blob&&window.navigator.msSaveOrOpenBlob){var a=new Blob([t]);window.navigator.msSaveBlob(a,i)}else{var o=Kekule.HtmlNativeServiceImpl._createAndExecDataIframe(e,t,i);o.parentNode.removeChild(o)}n&&n(null,null)},_createAndExecDataIframe:function(e,t,n){var r=e.createElement("iframe");e.body.appendChild(r);var i=r.contentWindow||r.contentDocument;i.document.open("text/html","replace");var a=t.toString();return i.document.write(a),i.document.close(),i.focus(),i.document.execCommand("SaveAs",!0,Kekule.UrlUtils.extractFileCoreName(n)),r}},Kekule.BrowserFeature.fileapi&&(e.doShowFilePickerDialog=Kekule.HtmlNativeServiceImpl.doShowFilePickerDialog),Kekule.Browser.IE||window.navigator.msSaveOrOpenBlob?e.doSaveFileData=Kekule.HtmlNativeServiceImpl.doSaveFileDataIe:Kekule.BrowserFeature.downloadHref&&(e.doSaveFileData=Kekule.HtmlNativeServiceImpl.doSaveFileData)}(),Kekule.PredefinedResLoader=Class.create(ObjectEx,{CLASS_NAME:"Kekule.PredefinedResLoader",initialize:function($super,e,t,n){$super(),t?(this.setPropStoreFieldValue("resUri",t),this.setDoc(e),n&&this.setResType(n)):Kekule.Error(Kekule.$L("ErrorMsg.EMPTY_RESURI"))},initProperties:function(){this.defineProp("doc",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("resUri",{dataType:DataType.STRING,serializable:!1,setter:null}),this.defineProp("resType",{dataType:DataType.STRING,serializable:!1})},getLinkedResUrl:function(e){var t=e.tagName.toLowerCase();return"link"===t?e.getAttribute("href"):"script"===t?e.getAttribute("src"):null},getElemResType:function(e){return e.getAttribute("type")},load:function(e){var t,n,r=this.getResUri(),i=Kekule.PredefinedResReferer.ID_MARK;if(r.startsWith(i)){var a=r.substr(i.length).trim();if(t=this.getDoc().getElementById(a)){n=this.getLinkedResUrl(t);var o=this.getElemResType(t);o&&this.setResType(o)}}else n=r;var l={resType:this.getResType(),resUri:r};if(n)Kekule.X.Ajax.sendRequest(n,function(t,r,i){if(i){if(!(l=Object.extend(l,{data:t,text:r.responseText,success:!0})).resType&&(l.resType=Kekule.X.Ajax.getResponseMimeType(r),l.resType===Kekule.IO.MimeType.OCTSTREAM)){var a=Kekule.UrlUtils.extractFileExt(n);if(a){var o=Kekule.IO.DataFormatsManager.findFormat(null,a);o&&(l.resType=o.mimeType)}}e(l,i)}else e(l,!1)},null,null,this.getResType()||null);else if(t){var u=t.innerHTML,s=2,c=u.indexOf("\r\n");c<0&&(c=u.indexOf("\n"),s=1),0===c&&(u=u.substring(s)),l=Object.extend(l,{data:u,text:u,resType:l.resType||"text/plain",success:!0}),e(l,!0)}else e(l,!1)}}),Kekule.PredefinedResReferer={REFER_PATTERN:/^\s*url\((\S+)\)\s*$/,ID_MARK:"#",isResValue:function(e){return Kekule.PredefinedResReferer.isResReferrer(e)},isResReferrer:function(e){return Kekule.PredefinedResReferer.REFER_PATTERN.test(e)},extractReferedValue:function(e){var t=Kekule.PredefinedResReferer.REFER_PATTERN.exec(e);if(t){var n=t[1];if(n)return n=Kekule.StrUtils.unquote(n)}return null},loadResource:function(e,t,n,r){r||(r=document);var i,a=Kekule.PredefinedResReferer.extractReferedValue(e);(i=new Kekule.PredefinedResLoader(r,a))&&(n&&i.setResType(n),i.load(t))}},Kekule._registerAfterLoadSysProc(function(){Kekule.IO&&(Kekule.IO.loadResourceData=function(e,t,n,r){Kekule.PredefinedResReferer.loadResource(e,function(e,n){var r;n&&(r=Kekule.IO.loadTypedData(e.data,e.resType,e.resUri)),t&&t(r,n)},n,r)})}),Kekule.DomUtils={namespaceMatched:function(e,t,n){return void 0===n&&(n=!0),e.namespaceURI==t||n&&!e.namespaceURI},isElement:function(e){return e&&e.tagName&&e.nodeType},getElementText:function(e){for(var t="",n=0,r=e.childNodes.length;n<r;++n)3==e.childNodes[n].nodeType&&(t+=e.childNodes[n].nodeValue);return t},setElementText:function(e,t){for(var n=0,r=e.childNodes.length;n<r;++n)if(3==e.childNodes[n].nodeType)return e.childNodes[n].nodeValue=t,t;var i=e.ownerDocument.createTextNode(t);return e.appendChild(i),t},getLocalName:function(e){return e.localName||e.baseName||e.nodeName},getChildNodesOfTypes:function(e,t){for(var n=[],r=Kekule.ArrayUtils.toArray(t),i=0,a=e.childNodes.length;i<a;++i){var o=e.childNodes[i];(!t||r.indexOf(o.nodeType)>=0)&&n.push(o)}return n},getFirstChildElem:function(e,t,n,r){for(var i=0,a=e.childNodes.length;i<a;++i){var o=e.childNodes[i];if(o.nodeType===Node.ELEMENT_NODE&&(t&&t.toLowerCase()===o.tagName.toLowerCase()||n&&n.toLowerCase()===Kekule.DomUtils.getLocalName(o).toLowerCase()||!t&&!n)&&(!r||Kekule.DomUtils.namespaceMatched(o,r)))return o}},getDirectChildElems:function(e,t,n,r){for(var i=[],a=0,o=e.childNodes.length;a<o;++a){var l=e.childNodes[a];l.nodeType===Node.ELEMENT_NODE&&(t&&t.toLowerCase()===l.tagName.toLowerCase()||n&&n.toLowerCase()===Kekule.DomUtils.getLocalName(l).toLowerCase()||!t&&!n)&&(r&&!Kekule.DomUtils.namespaceMatched(l,r)||i.push(l))}return i},getDirectChildElemsOfAttribValues:function(e,t,n,r,i){for(var a=Kekule.DomUtils.getDirectChildElems(e,n,r,i),o=[],l=0,u=a.length;l<u;++l){for(var s=!0,c=0,d=t.length;c<d;++c){var f=Kekule.ObjUtils.getOwnedFieldNames(t[c])[0];if(a[l].getAttribute(f)!=t[c][f]){s=!1;break}}s&&o.push(a[l])}return o},isDescendantOf:function(e,t){try{if(e&&t){if(e.documentElement)return!1;if(e.ownerDocument===t)return!0;for(var n=e.parentNode;n;){if(n===t)return!0;n=n.parentNode}}return!1}catch(e){return!1}},isOrIsDescendantOf:function(e,t){return e===t||Kekule.DomUtils.isDescendantOf(e,t)},getNearestAncestorByTagName:function(e,t,n){var r=t.toLowerCase();if(n&&e.tagName&&e.tagName.toLowerCase()===r)return e;for(var i=e.parentNode;i&&i.tagName;){if(i.tagName.toLowerCase()===r)return i;i=i.parentNode}return null},getSameNSAttributeValue:function(e,t,n){return e.getAttribute(t)},setSameNSAttributeValue:function(e,t,n,r){return e.setAttribute(t,n)},fetchAttributeValuesToArray:function(e,t,n){for(var r=[],i=0,a=e.attributes.length;i<a;++i){var o=e.attributes[i];if(!t||Kekule.DomUtils.namespaceMatched(o,t,!0)){var l;if(n)try{l=Kekule.DomUtils.getLocalName(o)}catch(e){l=o.name}else l=o.name;r.push({name:l,value:o.value})}}return r},fetchAttributeValuesToJson:function(e,t,n){for(var r={},i=0,a=e.attributes.length;i<a;++i){var o=e.attributes[i];if(!t||Kekule.DomUtils.namespaceMatched(o,t,!0)){var l;if(n)try{l=Kekule.DomUtils.getLocalName(o)}catch(e){l=o.name}else l=o.name;r[l]=o.value}}return r},hasAttribute:function(e,t){return e.hasAttribute?e.hasAttribute(t):!!e.getAttribute(t)},isDataAttribName:function(e){return e.toString().startsWith("data-")},getDataAttribCoreName:function(e){return Kekule.DomUtils.isDataAttribName(e)?e.substr(5):null},getDataAttrib:function(e,t){return e.dataset?e.dataset[t]:e.getAttribute("data-"+t.toString().hyphenize())},setDataAttrib:function(e,t,n){e.dataset?e.dataset[t]=n:e.setAttribute("data-"+t.toString().hyphenize(),n)},getDataset:function(e){if(e.dataset)return e.dataset;for(var t={},n=e.attributes,r=0,i=n.length;r<i;++r){var a=n[r],o=a.name;0===o.toLowerCase().indexOf("data-")&&(t[o.substring(5).camelize()]=a.value)}return t},clearChildContent:function(e){for(var t=Kekule.ArrayUtils.toArray(e.childNodes),n=t.length-1;n>=0;--n){var r=t[n];r.nodeType!==Node.ATTRIBUTE_NODE&&e.removeChild(r)}return e},replaceTagName:function(e,t){if(e.tagName.toLowerCase()!==t.toLowerCase()){for(var n=e.ownerDocument.createElement(t),r=Kekule.DomUtils.fetchAttributeValuesToArray(e),i=0,a=r.length;i<a;++i)n.setAttribute(r[i].name,r[i].value);var o=Kekule.DomUtils.getDirectChildElems(e);for(i=0,a=o.length;i<a;++i)n.appendChild(o[i]);var l=e.parentNode,u=e.nextSibling;return l.removeChild(e),u?l.insertBefore(n,u):l.appendChild(n),n}return e},setElemAttributes:function(e,t){for(var n=Kekule.ObjUtils.getOwnedFieldNames(t),r=0,i=n.length;r<i;++r){var a=n[r],o=t[a];a&&o&&e.setAttribute(a,o)}return e},isInDomTree:function(e,t){if(!e)return!1;if(t||(t=e.ownerDocument),t){var n=t.documentElement;return Kekule.DomUtils.isDescendantOf(e,n)||e===n}return!1}},Kekule.StyleUtils={removeStyleProperty:function(e,t){e.removeProperty?e.removeProperty(t):e.removeAttribute?e.removeAttribute(t):e[t]=null},analysisUnitsValue:function(e){var t,n={};if(n.total=e,n.value=parseFloat(e),e&&e.length&&void 0!==n.value&&!isNaN(n.value)){t="";for(var r=e.length-1;r>=0;--r){var i=e.charAt(r);i>="0"&&i<="9"||"."===i||"-"===i||(t=i+t)}}return n.units=t||"",n},multiplyUnitsValue:function(e,t){var n=Kekule.StyleUtils.analysisUnitsValue(e);return n.value*=t,""+n.value+n.units},colorStrToValue:function(e){var t=e.length>4,n=t?e.substr(1,2):e.substr(1,1),r=t?e.substr(3,2):e.substr(2,1),i=t?e.substr(5,2):e.substr(3,1);return t||(n+=n,r+=r,i+=i),(parseInt(n,16)<<16)+(parseInt(r,16)<<8)+parseInt(i,16)},getComputedStyle:function(e,t){var n,r=e.ownerDocument;if(!r)return null;var i=r.defaultView;return i&&i.getComputedStyle?n=i.getComputedStyle(e,null):e.currentStyle&&(n=e.currentStyle),n?t?n[t]:n:null},isShown:function(e){var t=Kekule.StyleUtils;return t.isDisplayed(e)&&t.isVisible(e)},isDisplayed:function(e){return"none"!==(Kekule.StyleUtils.getComputedStyle(e,"display")||"").toLowerCase()},getDisplayed:function(e){return Kekule.StyleUtils.getComputedStyle(e,"display")},setDisplay:function(e,t){e&&(e.style.display="string"==typeof t?t:t?"":"none")},isVisible:function(e){return"hidden"!==(Kekule.StyleUtils.getComputedStyle(e,"visibility")||"").toLowerCase()},getVisibility:function(e){return Kekule.StyleUtils.getComputedStyle(e,"visibility")},setVisibility:function(e,t){e&&(e.style.visibility="string"==typeof t?t:t?"":"hidden")},isBlockElem:function(e){var t=Kekule.StyleUtils.getComputedStyle(e,"display");return["block","list-item","table","flex","grid"].indexOf(t)>=0},isAbsOrFixPositioned:function(e){var t=Kekule.StyleUtils.getComputedStyle(e,"position")||"";return"absolute"===(t=t.toLowerCase())||"fixed"===t},_fillAbsOrFixedPositionStyleStack:function(e,t){var n=Kekule.StyleUtils.getComputedStyle(e,"position")||"";"absolute"!==(n=n.toLowerCase())&&"fixed"!==n||t.push(n.toLocaleLowerCase());var r=e.parentNode;return r&&r.ownerDocument&&Kekule.StyleUtils._fillAbsOrFixedPositionStyleStack(r,t),t},isAncestorPositionFixed:function(e){return!!e.parentNode&&Kekule.StyleUtils.isSelfOrAncestorPositionFixed(e)},isSelfOrAncestorPositionFixed:function(e){var t=[];if(Kekule.StyleUtils._fillAbsOrFixedPositionStyleStack(e,t),!t.length)return null;for(var n=t.length-1;n>=0;--n)if("fixed"===t[n])return!0;return!1},setCursor:function(e,t){if(DataType.isArrayValue(t)){for(var n=0,r=t.length;n<r;++n){var i=t[n];if(e.style.cursor=i,e.style.cursor===i)return i}return e.style.cursor}return e.style.cursor=t,e.style.cursor},_cssTransformValuesToMatrix:function(e){var t=Kekule.MatrixUtils.create(3,3,0);return t[0][0]=e.a,t[1][0]=e.b,t[0][1]=e.c,t[1][1]=e.d,t[0][2]=e.tx,t[1][2]=e.ty,t},_matrixToCssTransformValues:function(e){return{a:e[0][0],b:e[1][0],c:e[0][1],d:e[1][1],tx:e[0][2],ty:e[1][2]}},hasTransform:function(e){var t=Kekule.StyleUtils.getComputedStyle(e,"transform");return t&&"none"!==t},getTransformMatrixValues:function(e){var t=(Kekule.StyleUtils.getComputedStyle(e,"transform")||"").match(/-?[\d\.]+/g);return t?{a:t[0],b:t[1],c:t[2],d:t[3],tx:t[4],ty:t[5]}:null},setTransformMatrixArrayValues:function(e,t){if(t){var n="matrix("+t.join(",")+")";e.style.transform=n}},getTransformMatrix:function(e){var t=Kekule.StyleUtils.getTransformMatrixValues(e);return t?Kekule.StyleUtils._cssTransformValuesToMatrix(t):null},getCascadeTranformMatrixes:function(e){for(var t=[],n=e;n;){var r=Kekule.StyleUtils.getTransformMatrix(n);r&&t.unshift(r),n=n.parentNode}return t},getTotalTransformMatrix:function(e){for(var t=Kekule.StyleUtils.getCascadeTranformMatrixes(e),n=null,r=t.length-1;r>=0;--r){var i=t[r];n=n?Kekule.MatrixUtils.multiply(n,i):i}return n},calcInvertTransformMatrix:function(e){var t=Kekule.StyleUtils._matrixToCssTransformValues(e),n=t.a*t.d-t.b*t.c;if(Math.abs(n)<1e-6)return!1;var r={a:t.d/n,b:-t.b/n,c:-t.c/n,d:t.a/n,tx:(t.c*t.ty-t.d*t.tx)/n,ty:(t.b*t.tx-t.a*t.ty)/n};return Kekule.StyleUtils._cssTransformValuesToMatrix(r)}},Kekule.HtmlElementUtils={getClassNames:function(e){return Kekule.StrUtils.splitTokens(e.className)},hasClass:function(e,t){return Kekule.HtmlElementUtils.getClassNames(e).indexOf(t)>=0},addClass:function(e,t){for(var n=Kekule.HtmlElementUtils,r=Kekule.ArrayUtils.isArray(t)?t:Kekule.StrUtils.splitTokens(t),i=0,a=r.length;i<a;++i)n.hasClass(e,r[i])||(e.className+=" "+r[i]);return n},removeClass:function(e,t){for(var n=Kekule.HtmlElementUtils,r=Kekule.ArrayUtils.isArray(t)?t:Kekule.StrUtils.splitTokens(t),i=n.getClassNames(e),a=i.length;a>=0;--a)r.indexOf(i[a])>=0&&i.splice(a,1);return e.className=i.join(" "),n},toggleClass:function(e,t){for(var n=Kekule.HtmlElementUtils,r=Kekule.ArrayUtils.isArray(t)?t:Kekule.StrUtils.splitTokens(t),i=0,a=r.length;i<a;++i)n.hasClass(e,r[i])?n.removeClass(e,r[i]):n.addClass(e,r[i]);return n},getInnerText:function(e){return e.innerText||e.textContent},resizeElem:function(e,t,n,r){e.style.width=t+(r||"px"),e.style.height=n+(r||"px")},getElemClientDimension:function(e){return{width:e.clientWidth,height:e.clientHeight}},getElemScrollDimension:function(e){return{width:e.scrollWidth,height:e.scrollHeight}},getElemComputedDimension:function(e){var t=Kekule.StyleUtils,n={width:t.getComputedStyle(e,"width"),height:t.getComputedStyle(e,"height")},r=t.analysisUnitsValue(n.width),i=t.analysisUnitsValue(n.height),a={};return"px"===r.units&&(a.width=r.value),"px"===i.units&&(a.height=r.value),a},getElemOffsetDimension:function(e){return{width:e.offsetWidth,height:e.offsetHeight}},getViewportDimension:function(e){var t;if(e&&(t=e.ownerDocument?Kekule.DocumentUtils.getDefaultView(e.ownerDocument):e.defaultView?e.defaultView:e.parentWindow?e.parentWindow:e),null!=(t=t||window).innerWidth)return{width:t.innerWidth,height:t.innerHeight};var n=t.document;return"CSS1Compat"==n.compatMode?{width:n.documentElement.clientWidth,height:n.documentElement.clientHeight}:{width:n.body.clientWidth,height:n.body.clientHeight}},getViewportVisibleBox:function(e){var t;e&&(t=e.ownerDocument?Kekule.DocumentUtils.getDefaultView(e.ownerDocument):e.defaultView?e.defaultView:e.parentWindow?e.parentWindow:e);var n=(t=t||window).document,r=Kekule.HtmlElementUtils.getViewportDimension(t),i=Kekule.DocumentUtils.getScrollPosition(n),a={x1:i.left,y1:i.top,x2:r.width,y2:r.height};return a.left=a.x1,a.top=a.y1,a.right=a.x2,a.bottom=a.y2,a},getElemBoundingClientRect:function(e,t){var n=Object.extend({},e.getBoundingClientRect());if(Kekule.ObjUtils.isUnset(n.width)&&(n.width=n.right-n.left),Kekule.ObjUtils.isUnset(n.height)&&(n.height=n.bottom-n.top),t){var r=e.ownerDocument,i=r.documentElement.scrollTop||r.body.scrollTop||0,a=r.documentElement.scrollLeft||r.body.scrollLeft||0;n.left+=a,n.right+=a,n.top+=i,n.bottom+=i}var o=n;return o.x=o.left,o.y=o.top,o},getElemPagePos:function(e,t){for(var n=0,r=0,i=e;i;)n+=i.offsetLeft-i.scrollLeft+i.clientLeft,r+=i.offsetTop-i.scrollTop+i.clientTop,i=i.offsetParent;if(t){var a=e.ownerDocument,o=a.documentElement.scrollTop||a.body.scrollTop||0;n-=a.documentElement.scrollLeft||a.body.scrollLeft||0,r-=o}return{x:n,y:r}},getElemPageRect:function(e,t){var n=Kekule.HtmlElementUtils.getElemPagePos(e,t),r=Kekule.HtmlElementUtils.getElemClientDimension(e);return{x:n.x,y:n.y,left:n.x,top:n.y,right:n.x+r.width,bottom:n.y+r.height,width:r.width,height:r.height}},getElemViewportPos:function(e){var t=Kekule.HtmlElementUtils.getElemPagePos(e,!0);return{x:t.left,y:t.top}},makePositioned:function(e){var t=Kekule.StyleUtils.getComputedStyle(e,"position");t&&"static"!==t.toLowerCase()||(e.style.position="relative")},isFormCtrlElement:function(e){var t=e&&e.tagName.toLowerCase();return!!t&&["input","button","textarea","select"].indexOf(t)>=0},requestFullScreen:function(e){var t=e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullScreen;return t?t.apply(e):null},exitFullScreen:function(e){var t=e.exitFullScreen||e.mozExitFullScreen||e.webkitExitFullScreen||e.msExitFullScreen;return t?t.apply(e):null}},Kekule.DocumentUtils={getDefaultView:function(e){return e.defaultView||e.parentWindow},getScrollPosition:function(e){var t=Kekule.DocumentUtils.getDefaultView(e),n={left:(void 0!==t.pageXOffset?t.pageXOffset:(e.documentElement||e.body.parentNode||e.body).scrollLeft)||0,top:(void 0!==t.pageYOffset?t.pageYOffset:(e.documentElement||e.body.parentNode||e.body).scrollTop)||0};return n.x=n.left,n.y=n.top,n},getClientDimension:function(e){return"BackCompat"==e.compatMode?{width:e.body.clientWidth,height:e.body.clientHeight}:{width:e.documentElement.clientWidth,height:e.documentElement.clientHeight}},getClientVisibleBox:function(e){var t=Kekule.DocumentUtils.getScrollPosition(e),n=Kekule.DocumentUtils.getInnerClientDimension(e),r={};return r.left=r.x1=t.left,r.top=r.y1=t.top,r.right=r.x2=n.width+t.left,r.bottom=r.y2=n.height+t.top,r.width=n.width,r.height=n.height,r},getWindowInnerDimension:function(e){var t=Kekule.DocumentUtils.getDefaultView(e);return{width:Math.min(t.innerWidth,t.outerWidth),height:Math.min(t.innerHeight,t.outerHeight)}},getInnerClientDimension:function(e){var t=Kekule.DocumentUtils.getClientDimension(e),n=Kekule.DocumentUtils.getWindowInnerDimension(e);return{width:n.width?Math.min(n.width,t.width):t.width,height:n.height?Math.min(n.height,t.height):t.height}},getClientScaleLevel:function(e){return"BackCompat"==e.compatMode?e.body.clientWidth/window.innerWidth:e.documentElement.clientWidth/window.innerWidth},getPixelZoomLevel:function(e){return Kekule.DocumentUtils.getClientScaleLevel(e)*(Kekule.DocumentUtils.getDefaultView(e).devicePixelRatio||1)},getDevicePPI:function(e){var t=Kekule.DocumentUtils.getDefaultView(e);if(t.matchMedia){for(var n=0,r=0,i=200;!r||r-n>1;)t.matchMedia("(min-resolution: "+i+"dpi)").matches?r?(n=i,i=Math.round((n+r)/2)):(n=i,i*=2):(r=i,i=Math.round((n+r)/2));return i}return 96}},Kekule.DataSrcAttribUtils={isUrlBasedValue:function(e){return 0===e.toLowerCase().indexOf("url(")},getUrl:function(e){var t=e.trim();if(0===t.toLowerCase().indexOf("url(")){var n=t.lastIndexOf(")");return t=t.substring(4,n)}return null},getElementContent:function(e){if(!e)return null;var t=e.innerHTML;return t=t.ltrim()},getElementMimeType:function(e){return e.getAttribute("type")}},Kekule.ScriptFileUtils={_existedScriptUrls:new Kekule.MapEx,appendScriptFile:function(e,t,n){var r=Kekule.ScriptFileUtils._existedScriptUrls.get(e);if(r||(r=[],Kekule.ScriptFileUtils._existedScriptUrls.set(e,r)),!(r.indexOf(t)>=0)){var i=e.createElement("script");return i.src=t,i.onload=i.onreadystatechange=function(e){if(!i._loaded){var a=i.readyState;void 0!==a&&"loaded"!==a&&"complete"!==a||(i._loaded=!0,i.onload=i.onreadystatechange=null,r.push(t),n&&n())}},(e.getElementsByTagName("head")[0]||e.body).appendChild(i),i}n&&n()},appendScriptFiles:function(e,t,n){!function(e,t,n){if(t.length<=0)n&&n();else{var r=t.shift();Kekule.ScriptFileUtils.appendScriptFile(e,r,function(){Kekule.ScriptFileUtils.appendScriptFiles(e,t,n)})}}(e,[].concat(t),n)}},Kekule.DomHelper=Class.create(ObjectEx,{CLASS_NAME:"Kekule.DomHelper",NAMESPACE_DEFINE_PREFIX:"xmlns",NAMESPACE_DELIMITER:":",ERR_EMPTY_DOC:"Document is empty",ERR_ELEMENT_NOTSET:"Element not set",initialize:function($super,e){$super(),this._supportNsMethods=null,e&&this.setDocument(e)},initProperties:function(){this.defineProp("document",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("document");if(!e){var t=this.getPropStoreFieldValue("rootElement");e=t?t.ownerDocument:null}return e},setter:function(e){e!=this.getPropStoreFieldValue("document")&&(this.setPropStoreFieldValue("document",e),this.analysisRootElem())}}),this.defineProp("rootElement",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("rootElement");if(!e){var t=this.getPropStoreFieldValue("document");e=t?t.documentElement:null}return e},setter:function(e){this.setPropStoreFieldValue("rootElement",e),this.analysisRootElem()}}),this.defineProp("namespaces",{dataType:DataType.ARRAY,serializable:!1,getter:function(){return this.getPropStoreFieldValue("namespaces")||this.setPropStoreFieldValue("namespaces",[]),this.getPropStoreFieldValue("namespaces")}}),this.defineProp("defNamespaceURI",{dataType:DataType.STRING,serializable:!1}),this.defineProp("forceAnalysisDoc",{dataType:DataType.BOOL})},analysisRootElem:function(){this.setNamespaces([]),this.setDefNamespaceURI(null);var e=this.getRootElement();if(e){var t=e.ownerDocument;if(this._supportNsMethods=!!t.getElementsByTagNameNS,!this._supportNsMethods||this.getForceAnalysisDoc())for(var n=0,r=e.attributes.length;n<r;++n){var i=e.attributes[n],a=i.name;if(a&&a.indexOf(this.NAMESPACE_DEFINE_PREFIX)>=0){var o=i.value,l=a.indexOf(this.NAMESPACE_DELIMITER),u=l>=0?a.substring(l+1):null;this.getNamespaces().push({namespaceURI:o,prefix:u}),u||this.setDefNamespaceURI(o)}}}},_getEmptyDocErrorMsg:function(){return Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.EMPTY_DOC"):this.ERR_EMPTY_DOC},_getElementNotSetErrorMsg:function(){return Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.ELEMENT_NOTSET"):this.ELEMENT_NOTSET},assertDocAvailable:function(e){return!!e||(Kekule.raise(this._getEmptyDocErrorMsg()),!1)},assertElementAvailable:function(e){return!!e||(Kekule.raise(this._getElementNotSetErrorMsg()),!1)},getNsPrefix:function(e){if(e==this.getDefNamespaceURI())return"";for(var t=this.getNamespaces(),n=0,r=t.length;n<r;++n)if(t[n].namespaceURI==e)return t[n].prefix;return null},getQualifiedName:function(e,t){var n=this.getNsPrefix(e);return null===n?null:n?n+this.NAMESPACE_DELIMITER+t:t},createElementNS:function(e,t){var n=this.getDocument();return this.assertDocAvailable(n)?this._supportNsMethods?n.createElementNS(e,t):n.createElement(t):null},getElementsByTagNameNS:function(e,t,n){var r=this.getPropStoreFieldValue("document")||this.getPropStoreFieldValue("rootElement"),i=this.getDocument();if(!this.assertDocAvailable(i))return null;if(this._supportNsMethods)return n?n.getElementsByTagNameNS(e,t):r.getElementsByTagNameNS(e,t);var a=this.getQualifiedName(e,t);return null===a?[]:n?n.getElementsByTagName(a):r.getElementsByTagName(a)},getAttributeNodeNS:function(e,t,n){if(!this.assertElementAvailable(n))return null;if(this._supportNsMethods)return n.getAttributeNodeNS(e,t);var r=this.getQualifiedName(e,t);return null===r?null:n.getAttributeNode(r)},getAttributeNS:function(e,t,n){if(!this.assertElementAvailable(n))return null;if(this._supportNsMethods)return n.getAttributeNS(e,t);var r=this.getQualifiedName(e,t);return null===r?null:n.getAttribute(r)},setAttributeNS:function(e,t,n,r){if(!this.assertElementAvailable(r))return null;if(this._supportNsMethods)return r.setAttributeNS(e,t,n);var i=this.getQualifiedName(e,t);return null===i?null:r.setAttribute(i,n)}});